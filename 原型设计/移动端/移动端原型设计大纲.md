# 移动端原型设计大纲

## 1. 移动端架构概览

### 1.1 用户角色与权限
| 用户角色 | 权限范围 | 主要功能 |
|---------|---------|---------|
| 应急管理人员 | 预警+协调 | 预警接收、现场协调、应急通讯 |
| 专业技术人员 | 技术支持 | 现场技术支持、数据采集、设备维护 |
| 现场作业人员 | 全功能 | 数据采集、异常上报、安全作业、任务执行 |
| 公众用户 | 预警接收 | 预警信息接收、安全避险、信息查询 |

### 1.2 技术要求
- **手机端**: 375×667 (iPhone SE) 至 414×896 (iPhone 11 Pro Max)
- **平板端**: 768×1024 (iPad) 至 1024×1366 (iPad Pro)
- **系统支持**: iOS 12+、Android 8.0+
- **网络支持**: 4G/5G、WiFi、离线模式

### 1.3 设计原则
- **移动优先**: 针对移动设备特点优化设计
- **触控友好**: 最小点击区域44px，适合手指操作
- **简洁高效**: 减少操作步骤，突出核心功能
- **离线可用**: 关键功能支持离线使用

## 2. 页面层级结构

```
移动端App
├── 1. 首页 (/)
│   ├── 1.1 预警概览模块
│   ├── 1.2 快捷操作模块
│   └── 1.3 消息通知模块
├── 2. 预警中心 (/warning)
│   ├── 2.1 预警列表子页面 (/warning/list)
│   ├── 2.2 预警详情子页面 (/warning/detail/:id)
│   └── 2.3 预警设置子页面 (/warning/settings)
├── 3. 现场作业 (/field)
│   ├── 3.1 任务列表子页面 (/field/tasks)
│   ├── 3.2 数据采集子页面 (/field/collect)
│   ├── 3.3 异常上报子页面 (/field/report)
│   └── 3.4 安全导航子页面 (/field/navigation)
├── 4. 应急响应 (/emergency)
│   ├── 4.1 应急联系子页面 (/emergency/contacts)
│   ├── 4.2 应急预案子页面 (/emergency/plans)
│   ├── 4.3 求救功能子页面 (/emergency/help)
│   └── 4.4 撤离指引子页面 (/emergency/evacuation)
├── 5. 消息中心 (/messages)
│   ├── 5.1 系统消息子页面 (/messages/system)
│   ├── 5.2 任务通知子页面 (/messages/tasks)
│   └── 5.3 预警通知子页面 (/messages/warnings)
└── 6. 个人中心 (/profile)
    ├── 6.1 个人信息子页面 (/profile/info)
    ├── 6.2 设置中心子页面 (/profile/settings)
    └── 6.3 帮助中心子页面 (/profile/help)
```

## 3. 首页设计 (/)

### 3.1 页面布局
```
┌─────────────────────────────────┐
│ 状态栏：信号 | 时间 | 电池      │
├─────────────────────────────────┤
│ 导航栏：标题 | 搜索 | 设置      │
├─────────────────────────────────┤
│ 预警概览卡片                    │
│ ┌─────────────────────────────┐ │
│ │ 当前预警状态 | 风险等级     │ │
│ │ 最新预警信息 | 查看详情     │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 快捷操作区域                    │
│ ┌───────┐ ┌───────┐ ┌───────┐ │
│ │预警查看│ │现场上报│ │应急联系│ │
│ └───────┘ └───────┘ └───────┘ │
│ ┌───────┐ ┌───────┐ ┌───────┐ │
│ │数据采集│ │安全导航│ │求救功能│ │
│ └───────┘ └───────┘ └───────┘ │
├─────────────────────────────────┤
│ 消息通知列表                    │
│ - 系统消息                      │
│ - 任务通知                      │
│ - 预警更新                      │
├─────────────────────────────────┤
│ 底部导航：首页|预警|作业|消息|我的│
└─────────────────────────────────┘
```

### 3.2 模块组成
- **预警概览模块 (WarningOverview)**
  - 当前预警状态 (CurrentStatus)
  - 风险等级指示器 (RiskIndicator)
  - 最新预警摘要 (LatestWarning)
  - 快速查看按钮 (QuickView)

- **快捷操作模块 (QuickActions)**
  - 操作按钮网格 (ActionGrid)
  - 图标+文字设计 (IconText)
  - 权限控制显示 (PermissionControl)

- **消息通知模块 (NotificationList)**
  - 消息卡片 (MessageCard)
  - 未读标识 (UnreadBadge)
  - 时间显示 (TimeStamp)
  - 优先级标识 (PriorityFlag)

### 3.3 交互逻辑
**页面加载流程**：
1. App启动 → 检查登录状态 → 获取用户权限
2. 加载预警概览 → 获取最新预警数据
3. 渲染快捷操作 → 根据权限显示功能
4. 加载消息列表 → 获取未读消息
5. 启动推送服务 → 建立WebSocket连接
6. 定位服务初始化 → 获取当前位置

**实时更新逻辑**：
- **预警推送** → 弹窗提醒 + 声音震动 → 更新预警概览
- **任务分配** → 推送通知 → 更新消息列表
- **紧急事件** → 强制弹窗 → 引导应急操作
- **位置变化** → 检查风险区域 → 安全提醒

## 4. 现场作业模块设计

### 4.1 数据采集子页面 (/field/collect)
**页面布局**：
```
┌─────────────────────────────────┐
│ 导航栏：返回 | 数据采集 | 帮助   │
├─────────────────────────────────┤
│ 位置信息卡片                    │
│ ┌─────────────────────────────┐ │
│ │ GPS坐标 | 精度 | 地址信息   │ │
│ │ 刷新位置 | 手动输入坐标     │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 数据录入表单                    │
│ - 监测点选择                    │
│ - 数据类型选择                  │
│ - 数值输入                      │
│ - 备注说明                      │
├─────────────────────────────────┤
│ 多媒体采集                      │
│ ┌───────┐ ┌───────┐ ┌───────┐ │
│ │ 拍照  │ │ 录音  │ │ 录像  │ │
│ └───────┘ └───────┘ └───────┘ │
├─────────────────────────────────┤
│ 已采集数据列表                  │
│ - 数据项1 [已保存]              │
│ - 数据项2 [待上传]              │
├─────────────────────────────────┤
│ 操作按钮：保存草稿 | 提交数据    │
└─────────────────────────────────┘
```

**模块组成**：
- **位置信息模块 (LocationInfo)**
  - GPS定位器 (GPSLocator)
  - 坐标显示器 (CoordinateDisplay)
  - 地址解析器 (AddressResolver)
  - 精度指示器 (AccuracyIndicator)

- **数据录入模块 (DataInput)**
  - 表单控件 (FormControls)
  - 数据验证器 (DataValidator)
  - 自动保存器 (AutoSaver)
  - 模板选择器 (TemplateSelector)

- **媒体采集模块 (MediaCapture)**
  - 相机控制器 (CameraController)
  - 录音控制器 (AudioController)
  - 文件管理器 (FileManager)
  - 压缩上传器 (CompressUploader)

**交互逻辑**：
1. **页面进入** → 获取GPS位置 → 显示位置信息
2. **选择监测点** → 加载点位信息 → 预填表单数据
3. **数据录入** → 实时验证 → 自动保存草稿
4. **媒体采集** → 调用设备功能 → 本地存储文件
5. **数据提交** → 验证完整性 → 上传到服务器
6. **离线处理** → 本地存储 → 网络恢复后同步

### 4.2 异常上报子页面 (/field/report)
**页面布局**：
```
┌─────────────────────────────────┐
│ 导航栏：返回 | 异常上报 | 紧急   │
├─────────────────────────────────┤
│ 紧急程度选择                    │
│ ○ 一般异常  ○ 重要异常  ● 紧急 │
├─────────────────────────────────┤
│ 异常类型选择                    │
│ ┌───────┐ ┌───────┐ ┌───────┐ │
│ │设备故障│ │数据异常│ │安全隐患│ │
│ └───────┘ └───────┘ └───────┘ │
│ ┌───────┐ ┌───────┐ ┌───────┐ │
│ │地质变化│ │环境异常│ │其他异常│ │
│ └───────┘ └───────┘ └───────┘ │
├─────────────────────────────────┤
│ 异常描述                        │
│ ┌─────────────────────────────┐ │
│ │ 请详细描述发现的异常情况... │ │
│ │                             │ │
│ │                             │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 现场照片                        │
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐│
│ │照片1│ │照片2│ │照片3│ │ +  ││
│ └─────┘ └─────┘ └─────┘ └─────┘│
├─────────────────────────────────┤
│ 联系方式                        │
│ 手机：[___________] ☑ 接受回访  │
├─────────────────────────────────┤
│ 操作按钮：保存草稿 | 立即上报    │
└─────────────────────────────────┘
```

### 4.3 安全导航子页面 (/field/navigation)
**页面布局**：
```
┌─────────────────────────────────┐
│ 导航栏：返回 | 安全导航 | 设置   │
├─────────────────────────────────┤
│ 目的地信息                      │
│ ┌─────────────────────────────┐ │
│ │ 目标：XX监测点               │ │
│ │ 距离：2.3公里  预计：15分钟  │ │
│ │ 风险等级：低风险             │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 地图导航区域                    │
│ ┌─────────────────────────────┐ │
│ │                             │ │
│ │        📍 当前位置           │ │
│ │          ↓                  │ │
│ │        🛣️ 安全路径          │ │
│ │          ↓                  │ │
│ │        🎯 目标位置           │ │
│ │                             │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 路况信息                        │
│ ┌─────────────────────────────┐ │
│ │ ⚠️ 前方500米有积水路段       │ │
│ │ ✅ 备选路径畅通             │ │
│ │ 📡 GPS信号：强               │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 操作按钮：开始导航 | 紧急求助    │
└─────────────────────────────────┘
```

## 5. 应急响应模块设计

### 5.1 应急联系子页面 (/emergency/contacts)
**页面布局**：
```
┌─────────────────────────────────┐
│ 导航栏：返回 | 应急联系 | 编辑   │
├─────────────────────────────────┤
│ 紧急联系按钮                    │
│ ┌─────────────────────────────┐ │
│ │ 🚨 一键报警：110            │ │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ 🚑 医疗急救：120            │ │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ 🚒 消防救援：119            │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 应急指挥联系                    │
│ ┌─────────────────────────────┐ │
│ │ 👤 张指挥员  📞 138****1234 │ │
│ │ 💬 发消息    📹 视频通话    │ │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ 👤 李专家    📞 139****5678 │ │
│ │ 💬 发消息    📹 视频通话    │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 现场团队联系                    │
│ ┌─────────────────────────────┐ │
│ │ 👥 现场小组 (5人在线)       │ │
│ │ 💬 群组聊天  📹 群组通话    │ │
│ └─────────────────────────────┘ │
└─────────────────────────────────┘
```

### 5.2 求救功能子页面 (/emergency/help)
**页面布局**：
```
┌─────────────────────────────────┐
│ 导航栏：返回 | 紧急求救 | 取消   │
├─────────────────────────────────┤
│ 紧急情况选择                    │
│ ┌───────┐ ┌───────┐ ┌───────┐ │
│ │人员受伤│ │设备故障│ │迷路困难│ │
│ └───────┘ └───────┘ └───────┘ │
│ ┌───────┐ ┌───────┐ ┌───────┐ │
│ │地质灾害│ │恶劣天气│ │其他紧急│ │
│ └───────┘ └───────┘ └───────┘ │
├─────────────────────────────────┤
│ 当前位置信息                    │
│ ┌─────────────────────────────┐ │
│ │ 📍 经度：104.0668           │ │
│ │ 📍 纬度：30.5728            │ │
│ │ 📍 地址：成都市武侯区...     │ │
│ │ 📍 精度：±5米               │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 紧急描述                        │
│ ┌─────────────────────────────┐ │
│ │ 请简要描述紧急情况...       │ │
│ │                             │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ 联系信息                        │
│ 姓名：[_______] 手机：[_______] │
├─────────────────────────────────┤
│ 求救按钮                        │
│ ┌─────────────────────────────┐ │
│ │        🆘 发送求救信号       │ │
│ │      (长按3秒确认发送)       │ │
│ └─────────────────────────────┘ │
└─────────────────────────────────┘
```

## 6. 离线功能设计

### 6.1 离线数据管理
**离线存储内容**：
- 基础地图数据 (最近访问区域)
- 监测点位信息 (基础信息和历史数据)
- 应急联系人信息
- 应急预案文档
- 用户采集的数据 (待同步)

**存储策略**：
- 关键数据优先存储
- 定期清理过期数据
- 压缩存储节省空间
- 增量同步减少流量

### 6.2 离线功能范围
**可用功能**：
- 查看缓存的监测数据
- 填写数据采集表单
- 查看应急联系人
- 查看应急预案
- 拍照录音记录

**受限功能**：
- 实时数据更新
- 预警信息推送
- 视频通话功能
- 在线地图服务
- 数据实时上传

### 6.3 同步机制
**自动同步**：
- 网络恢复时自动同步
- WiFi环境下优先同步
- 后台同步不影响使用
- 同步进度实时显示

**手动同步**：
- 用户主动触发同步
- 选择性同步数据
- 同步状态清晰反馈
- 同步失败重试机制

## 7. 推送通知设计

### 7.1 通知类型
**预警通知**：
- 新预警发布通知
- 预警等级变更通知
- 预警解除通知
- 区域风险提醒

**任务通知**：
- 新任务分配通知
- 任务状态变更通知
- 任务截止提醒
- 任务完成确认

**系统通知**：
- 系统维护通知
- 版本更新通知
- 功能变更通知
- 安全提醒通知

### 7.2 通知样式
**通知栏样式**：
- 应用图标 + 标题 + 内容摘要
- 时间戳 + 优先级标识
- 操作按钮 (查看详情、忽略)
- 声音 + 震动 + LED指示

**应用内样式**：
- 弹窗通知 (紧急情况)
- 横幅通知 (一般情况)
- 角标提醒 (未读数量)
- 列表展示 (历史通知)

### 7.3 通知设置
**推送设置**：
- 通知开关 (总开关)
- 分类设置 (预警、任务、系统)
- 时间设置 (免打扰时间)
- 方式设置 (声音、震动、LED)

**权限管理**：
- 通知权限申请
- 位置权限申请
- 相机权限申请
- 存储权限申请

## 8. 性能优化

### 8.1 启动优化
- 启动页面优化
- 关键资源预加载
- 延迟加载非关键功能
- 启动时间控制在3秒内

### 8.2 运行优化
- 内存使用优化
- 电池消耗控制
- 网络请求优化
- 图片压缩处理

### 8.3 体验优化
- 操作响应及时
- 加载状态清晰
- 错误处理友好
- 离线体验流畅
