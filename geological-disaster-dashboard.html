<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âú∞Ë¥®ÁÅæÂÆ≥È¢ÑË≠¶Á≥ªÁªü - ÂÆûÊó∂ÁõëÊéßÂ§ßÂ±è</title>
    
    <!-- CesiumJS CDN -->
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.131/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.131/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    
    <!-- ECharts CDN -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>

    <!-- Google Fonts - ÁßëÊäÄÊÑüÂ≠ó‰Ωì -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Orbitron', 'Roboto Mono', 'PingFang SC', 'Microsoft YaHei', monospace;
            background:
                radial-gradient(ellipse at top, #0f1419 0%, #0a0e1a 50%, #000000 100%),
                linear-gradient(135deg, #001122 0%, #002244 25%, #000011 50%, #001133 75%, #000000 100%);
            color: #00ffff;
            overflow: hidden;
            height: 100vh;
            position: relative;
        }

        /* Âä®ÊÄÅÁ≤íÂ≠êËÉåÊôØ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(2px 2px at 20px 30px, #00ffff, transparent),
                radial-gradient(2px 2px at 40px 70px, #0099ff, transparent),
                radial-gradient(1px 1px at 90px 40px, #ffffff, transparent),
                radial-gradient(1px 1px at 130px 80px, #00ffff, transparent),
                radial-gradient(2px 2px at 160px 30px, #0066ff, transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: sparkle 20s linear infinite;
            opacity: 0.3;
            z-index: -1;
        }

        @keyframes sparkle {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-100px); }
        }

        /* Êâ´ÊèèÁ∫øÊïàÊûú */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ffff, transparent);
            animation: scan 3s linear infinite;
            z-index: 1;
        }

        @keyframes scan {
            0% { top: 0%; opacity: 1; }
            50% { opacity: 0.8; }
            100% { top: 100%; opacity: 0; }
        }

        /* È°∂ÈÉ®ÂØºËà™Ê†è */
        .header {
            height: 80px;
            background:
                linear-gradient(135deg, rgba(0,255,255,0.1) 0%, rgba(0,150,255,0.1) 50%, rgba(0,100,200,0.1) 100%),
                linear-gradient(90deg, #001122 0%, #002244 50%, #001122 100%);
            border-bottom: 2px solid #00ffff;
            box-shadow:
                0 0 20px rgba(0,255,255,0.3),
                0 4px 20px rgba(0,0,0,0.5),
                inset 0 1px 0 rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            position: relative;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, #00ffff, transparent);
            animation: headerGlow 2s ease-in-out infinite alternate;
        }

        @keyframes headerGlow {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo {
            width: 56px;
            height: 56px;
            background:
                radial-gradient(circle, #00ffff 0%, #0099ff 50%, #0066cc 100%);
            border: 2px solid #00ffff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #000011;
            font-weight: 900;
            font-family: 'Orbitron', monospace;
            box-shadow:
                0 0 20px rgba(0,255,255,0.5),
                inset 0 2px 4px rgba(255,255,255,0.3);
            animation: logoRotate 10s linear infinite;
            position: relative;
        }

        .logo::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border: 1px solid #00ffff;
            border-radius: 50%;
            animation: logoPulse 2s ease-in-out infinite;
        }

        @keyframes logoRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes logoPulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        .system-title {
            font-size: 28px;
            font-weight: 900;
            font-family: 'Orbitron', monospace;
            color: #00ffff;
            text-shadow:
                0 0 10px #00ffff,
                0 0 20px #00ffff,
                0 0 30px #00ffff;
            letter-spacing: 2px;
            animation: titleGlow 3s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            0% {
                text-shadow:
                    0 0 10px #00ffff,
                    0 0 20px #00ffff,
                    0 0 30px #00ffff;
            }
            100% {
                text-shadow:
                    0 0 15px #00ffff,
                    0 0 25px #00ffff,
                    0 0 35px #00ffff,
                    0 0 45px #0099ff;
            }
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background:
                linear-gradient(135deg, rgba(0,255,255,0.1) 0%, rgba(0,150,255,0.1) 100%);
            border: 1px solid rgba(0,255,255,0.3);
            border-radius: 25px;
            box-shadow:
                0 0 15px rgba(0,255,255,0.2),
                inset 0 1px 0 rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #00ff88;
            box-shadow:
                0 0 10px #00ff88,
                0 0 20px #00ff88;
            animation: statusPulse 2s infinite;
            position: relative;
        }

        .status-dot::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border: 1px solid #00ff88;
            border-radius: 50%;
            animation: statusRipple 2s infinite;
        }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        @keyframes statusRipple {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(2); }
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background:
                linear-gradient(135deg, rgba(0,255,255,0.1) 0%, rgba(0,150,255,0.1) 100%);
            border: 1px solid rgba(0,255,255,0.3);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .user-info:hover {
            background:
                linear-gradient(135deg, rgba(0,255,255,0.2) 0%, rgba(0,150,255,0.2) 100%);
            box-shadow: 0 0 20px rgba(0,255,255,0.3);
            transform: translateY(-2px);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background:
                radial-gradient(circle, #00ffff 0%, #0099ff 100%);
            color: #000011;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-family: 'Orbitron', monospace;
            border: 2px solid #00ffff;
            box-shadow:
                0 0 15px rgba(0,255,255,0.5),
                inset 0 2px 4px rgba(255,255,255,0.3);
        }

        /* ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü */
        .main-container {
            display: flex;
            height: calc(100vh - 80px);
        }

        /* Â∑¶‰æßËèúÂçï */
        .sidebar {
            width: 280px;
            background:
                linear-gradient(180deg, rgba(0,20,40,0.9) 0%, rgba(0,10,30,0.9) 100%);
            backdrop-filter: blur(15px);
            border-right: 2px solid rgba(0,255,255,0.3);
            box-shadow:
                inset -1px 0 0 rgba(0,255,255,0.1),
                2px 0 20px rgba(0,0,0,0.5);
            padding: 32px 0;
            position: relative;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 1px;
            height: 100%;
            background: linear-gradient(180deg, transparent, #00ffff, transparent);
            animation: sidebarGlow 3s ease-in-out infinite alternate;
        }

        @keyframes sidebarGlow {
            0% { opacity: 0.3; }
            100% { opacity: 0.8; }
        }

        .menu-item {
            padding: 16px 32px;
            margin: 8px 16px;
            cursor: pointer;
            transition: all 0.4s ease;
            border-left: 4px solid transparent;
            border-radius: 0 25px 25px 0;
            font-family: 'Roboto Mono', monospace;
            font-weight: 500;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .menu-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .menu-item:hover::before {
            left: 100%;
        }

        .menu-item:hover {
            background:
                linear-gradient(135deg, rgba(0,255,255,0.1) 0%, rgba(0,150,255,0.1) 100%);
            border-left-color: #00ffff;
            color: #00ffff;
            box-shadow:
                0 0 15px rgba(0,255,255,0.2),
                inset 0 1px 0 rgba(255,255,255,0.1);
            transform: translateX(8px);
        }

        .menu-item.active {
            background:
                linear-gradient(135deg, rgba(0,255,255,0.2) 0%, rgba(0,150,255,0.2) 100%);
            border-left-color: #00ffff;
            color: #00ffff;
            box-shadow:
                0 0 20px rgba(0,255,255,0.3),
                inset 0 1px 0 rgba(255,255,255,0.2);
            transform: translateX(12px);
        }

        .menu-item.active::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid #00ffff;
        }

        .menu-icon {
            display: inline-block;
            width: 24px;
            margin-right: 16px;
            font-size: 18px;
            text-align: center;
        }

        /* ‰∏≠Â§ÆÂú∞ÂõæÂå∫Âüü */
        .map-container {
            flex: 1;
            position: relative;
            background: #000;
        }

        #cesiumContainer {
            width: 100%;
            height: 100%;
        }

        /* Âú∞ÂõæÂ∑•ÂÖ∑Ê†è */
        .map-toolbar {
            position: absolute;
            top: 24px;
            left: 24px;
            z-index: 100;
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .toolbar-btn {
            padding: 12px 20px;
            background:
                linear-gradient(135deg, rgba(0,20,40,0.9) 0%, rgba(0,10,30,0.9) 100%);
            color: #00ffff;
            border: 1px solid rgba(0,255,255,0.3);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.4s ease;
            backdrop-filter: blur(15px);
            font-family: 'Roboto Mono', monospace;
            font-weight: 500;
            font-size: 14px;
            letter-spacing: 0.5px;
            box-shadow:
                0 4px 15px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
        }

        .toolbar-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .toolbar-btn:hover::before {
            left: 100%;
        }

        .toolbar-btn:hover {
            background:
                linear-gradient(135deg, rgba(0,255,255,0.2) 0%, rgba(0,150,255,0.2) 100%);
            border-color: #00ffff;
            box-shadow:
                0 0 20px rgba(0,255,255,0.4),
                0 4px 20px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .toolbar-btn.active {
            background:
                linear-gradient(135deg, rgba(0,255,255,0.3) 0%, rgba(0,150,255,0.3) 100%);
            border-color: #00ffff;
            box-shadow:
                0 0 25px rgba(0,255,255,0.5),
                0 4px 20px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.3);
            color: #ffffff;
        }

        .toolbar-btn.active::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            border: 1px solid rgba(0,255,255,0.5);
            border-radius: 23px;
            animation: activeGlow 2s ease-in-out infinite alternate;
        }

        @keyframes activeGlow {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Âè≥‰æß‰ø°ÊÅØÈù¢Êùø */
        .info-panel {
            width: 400px;
            background:
                linear-gradient(180deg, rgba(0,20,40,0.9) 0%, rgba(0,10,30,0.9) 100%);
            backdrop-filter: blur(15px);
            border-left: 2px solid rgba(0,255,255,0.3);
            box-shadow:
                inset 1px 0 0 rgba(0,255,255,0.1),
                -2px 0 20px rgba(0,0,0,0.5);
            padding: 32px 24px;
            overflow-y: auto;
            position: relative;
        }

        .info-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 1px;
            height: 100%;
            background: linear-gradient(180deg, transparent, #00ffff, transparent);
            animation: panelGlow 3s ease-in-out infinite alternate;
        }

        @keyframes panelGlow {
            0% { opacity: 0.3; }
            100% { opacity: 0.8; }
        }

        /* KPIÂç°ÁâáÁªÑ */
        .kpi-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 32px;
        }

        .kpi-card {
            background:
                linear-gradient(135deg, rgba(0,255,255,0.1) 0%, rgba(0,150,255,0.1) 100%);
            border: 1px solid rgba(0,255,255,0.3);
            border-radius: 15px;
            padding: 20px 16px;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
            box-shadow:
                0 4px 15px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ffff, transparent);
            animation: cardScan 3s linear infinite;
        }

        @keyframes cardScan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .kpi-card:hover {
            transform: translateY(-4px);
            box-shadow:
                0 8px 25px rgba(0,255,255,0.2),
                0 4px 15px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.2);
            border-color: #00ffff;
        }

        .kpi-value {
            font-size: 28px;
            font-weight: 900;
            font-family: 'Orbitron', monospace;
            color: #00ffff;
            margin-bottom: 8px;
            text-shadow:
                0 0 10px #00ffff,
                0 0 20px #00ffff;
            animation: valueGlow 2s ease-in-out infinite alternate;
        }

        @keyframes valueGlow {
            0% {
                text-shadow:
                    0 0 10px #00ffff,
                    0 0 20px #00ffff;
            }
            100% {
                text-shadow:
                    0 0 15px #00ffff,
                    0 0 25px #00ffff,
                    0 0 35px #0099ff;
            }
        }

        .kpi-label {
            font-size: 12px;
            color: #99ccff;
            font-family: 'Roboto Mono', monospace;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* È¢ÑË≠¶‰ø°ÊÅØÂàóË°® */
        .warning-section {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
            margin-bottom: 20px;
            color: #00ffff;
            display: flex;
            align-items: center;
            gap: 12px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow:
                0 0 10px #00ffff,
                0 0 20px #00ffff;
            position: relative;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, #00ffff, transparent);
            margin-left: 16px;
        }

        .warning-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .warning-item {
            background:
                linear-gradient(135deg, rgba(255,77,79,0.1) 0%, rgba(255,77,79,0.05) 100%);
            border: 1px solid rgba(255,77,79,0.4);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
            box-shadow:
                0 4px 15px rgba(255,77,79,0.1),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .warning-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: #ff4d4f;
            box-shadow: 0 0 10px #ff4d4f;
        }

        .warning-item:hover {
            transform: translateX(8px);
            box-shadow:
                0 8px 25px rgba(255,77,79,0.2),
                inset 0 1px 0 rgba(255,255,255,0.2);
        }

        .warning-item.orange {
            background:
                linear-gradient(135deg, rgba(250,140,22,0.1) 0%, rgba(250,140,22,0.05) 100%);
            border-color: rgba(250,140,22,0.4);
            box-shadow:
                0 4px 15px rgba(250,140,22,0.1),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .warning-item.orange::before {
            background: #fa8c16;
            box-shadow: 0 0 10px #fa8c16;
        }

        .warning-item.orange:hover {
            box-shadow:
                0 8px 25px rgba(250,140,22,0.2),
                inset 0 1px 0 rgba(255,255,255,0.2);
        }

        .warning-item.yellow {
            background:
                linear-gradient(135deg, rgba(250,219,20,0.1) 0%, rgba(250,219,20,0.05) 100%);
            border-color: rgba(250,219,20,0.4);
            box-shadow:
                0 4px 15px rgba(250,219,20,0.1),
                inset 0 1px 0 rgba(255,255,255,0.1);
        }

        .warning-item.yellow::before {
            background: #fadb14;
            box-shadow: 0 0 10px #fadb14;
        }

        .warning-item.yellow:hover {
            box-shadow:
                0 8px 25px rgba(250,219,20,0.2),
                inset 0 1px 0 rgba(255,255,255,0.2);
        }

        .warning-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .warning-level {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 700;
            font-family: 'Roboto Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .warning-level::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: levelScan 2s linear infinite;
        }

        @keyframes levelScan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .warning-level.red {
            background:
                linear-gradient(135deg, #FF4D4F 0%, #d32f2f 100%);
            color: #ffffff;
            box-shadow:
                0 0 15px rgba(255,77,79,0.5),
                inset 0 1px 0 rgba(255,255,255,0.3);
        }

        .warning-level.orange {
            background:
                linear-gradient(135deg, #FA8C16 0%, #e65100 100%);
            color: #ffffff;
            box-shadow:
                0 0 15px rgba(250,140,22,0.5),
                inset 0 1px 0 rgba(255,255,255,0.3);
        }

        .warning-level.yellow {
            background:
                linear-gradient(135deg, #FADB14 0%, #f57f17 100%);
            color: #000000;
            box-shadow:
                0 0 15px rgba(250,219,20,0.5),
                inset 0 1px 0 rgba(255,255,255,0.3);
        }

        .warning-time {
            font-size: 12px;
            color: #8C8C8C;
        }

        .warning-content {
            font-size: 14px;
            line-height: 1.4;
        }

        /* ËÆæÂ§áÁä∂ÊÄÅ */
        .device-status {
            margin-bottom: 24px;
        }

        .device-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .device-name {
            font-size: 14px;
        }

        .device-status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            position: relative;
            animation: devicePulse 2s infinite;
        }

        .device-status-dot::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 50%;
            animation: deviceRipple 2s infinite;
        }

        .device-status-dot.online {
            background: #00ff88;
            box-shadow:
                0 0 10px #00ff88,
                0 0 20px #00ff88;
        }

        .device-status-dot.online::before {
            border: 1px solid #00ff88;
        }

        .device-status-dot.offline {
            background: #666666;
            box-shadow:
                0 0 5px #666666;
        }

        .device-status-dot.offline::before {
            border: 1px solid #666666;
        }

        .device-status-dot.warning {
            background: #ff8800;
            box-shadow:
                0 0 10px #ff8800,
                0 0 20px #ff8800;
            animation: warningBlink 1s infinite;
        }

        .device-status-dot.warning::before {
            border: 1px solid #ff8800;
        }

        @keyframes devicePulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        @keyframes deviceRipple {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(2); }
        }

        @keyframes warningBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Â∫ïÈÉ®Áä∂ÊÄÅÊ†è */
        .footer {
            height: 56px;
            background:
                linear-gradient(90deg, rgba(0,20,40,0.9) 0%, rgba(0,10,30,0.9) 50%, rgba(0,20,40,0.9) 100%);
            border-top: 2px solid rgba(0,255,255,0.3);
            box-shadow:
                inset 0 1px 0 rgba(0,255,255,0.1),
                0 -2px 20px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
            font-size: 13px;
            font-family: 'Roboto Mono', monospace;
            color: #99ccff;
            backdrop-filter: blur(10px);
            position: relative;
        }

        .footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, #00ffff, transparent);
            animation: footerGlow 3s ease-in-out infinite alternate;
        }

        @keyframes footerGlow {
            0% { opacity: 0.3; }
            100% { opacity: 0.8; }
        }

        .footer span {
            color: #00ffff;
            font-weight: 500;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 1366px) {
            .sidebar {
                width: 200px;
            }
            
            .info-panel {
                width: 300px;
            }
            
            .kpi-cards {
                grid-template-columns: 1fr;
            }
        }

        /* Âä†ËΩΩÂä®Áîª */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(ellipse at center, #001122 0%, #000000 70%),
                linear-gradient(135deg, #0c1426 0%, #1a2332 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 3px solid transparent;
            border-top: 3px solid #00ffff;
            border-right: 3px solid #0099ff;
            border-radius: 50%;
            animation: spinGlow 1.5s linear infinite;
            margin-bottom: 30px;
            position: relative;
            box-shadow:
                0 0 20px rgba(0,255,255,0.5),
                inset 0 0 20px rgba(0,255,255,0.1);
        }

        .loading-spinner::before {
            content: '';
            position: absolute;
            top: -6px;
            left: -6px;
            right: -6px;
            bottom: -6px;
            border: 1px solid rgba(0,255,255,0.3);
            border-radius: 50%;
            animation: spinGlow 2s linear infinite reverse;
        }

        .loading-spinner::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background:
                radial-gradient(circle, #00ffff 0%, #0099ff 100%);
            border-radius: 50%;
            box-shadow: 0 0 15px #00ffff;
            animation: centerPulse 1s ease-in-out infinite alternate;
        }

        @keyframes spinGlow {
            0% {
                transform: rotate(0deg);
                box-shadow:
                    0 0 20px rgba(0,255,255,0.5),
                    inset 0 0 20px rgba(0,255,255,0.1);
            }
            50% {
                box-shadow:
                    0 0 30px rgba(0,255,255,0.8),
                    inset 0 0 30px rgba(0,255,255,0.2);
            }
            100% {
                transform: rotate(360deg);
                box-shadow:
                    0 0 20px rgba(0,255,255,0.5),
                    inset 0 0 20px rgba(0,255,255,0.1);
            }
        }

        @keyframes centerPulse {
            0% {
                transform: translate(-50%, -50%) scale(1);
                box-shadow: 0 0 15px #00ffff;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.2);
                box-shadow: 0 0 25px #00ffff;
            }
        }

        .loading-text {
            font-size: 24px;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            color: #00ffff;
            margin-bottom: 16px;
            text-shadow:
                0 0 10px #00ffff,
                0 0 20px #00ffff,
                0 0 30px #00ffff;
            letter-spacing: 3px;
            animation: textGlow 2s ease-in-out infinite alternate;
        }

        @keyframes textGlow {
            0% {
                text-shadow:
                    0 0 10px #00ffff,
                    0 0 20px #00ffff,
                    0 0 30px #00ffff;
            }
            100% {
                text-shadow:
                    0 0 15px #00ffff,
                    0 0 25px #00ffff,
                    0 0 35px #00ffff,
                    0 0 45px #0099ff;
            }
        }

        .loading-progress {
            font-size: 16px;
            font-family: 'Roboto Mono', monospace;
            color: #99ccff;
            letter-spacing: 1px;
            animation: progressFade 1.5s ease-in-out infinite alternate;
        }

        @keyframes progressFade {
            0% { opacity: 0.6; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Âä†ËΩΩÈÅÆÁΩ© -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Âú∞Ë¥®ÁÅæÂÆ≥È¢ÑË≠¶Á≥ªÁªü</div>
        <div class="loading-progress">Ê≠£Âú®ÂàùÂßãÂåñÁ≥ªÁªü...</div>
    </div>

    <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
    <header class="header">
        <div class="header-left">
            <div class="logo">‚ö°</div>
            <h1 class="system-title">Âú∞Ë¥®ÁÅæÂÆ≥È¢ÑË≠¶Á≥ªÁªü</h1>
        </div>
        <div class="header-right">
            <div class="status-indicator">
                <div class="status-dot"></div>
                <span>Á≥ªÁªüÊ≠£Â∏∏</span>
            </div>
            <div class="user-info">
                <div class="user-avatar">ÁÆ°</div>
                <span>ÁÆ°ÁêÜÂëò</span>
            </div>
        </div>
    </header>

    <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
    <div class="main-container">
        <!-- Â∑¶‰æßËèúÂçï -->
        <nav class="sidebar">
            <div class="menu-item active">
                <span class="menu-icon">‚óâ</span>
                ÂÆûÊó∂ÁõëÊéß
            </div>
            <div class="menu-item">
                <span class="menu-icon">‚ñ≥</span>
                È¢ÑË≠¶ÁÆ°ÁêÜ
            </div>
            <div class="menu-item">
                <span class="menu-icon">‚ñ≤</span>
                Êï∞ÊçÆÂàÜÊûê
            </div>
            <div class="menu-item">
                <span class="menu-icon">‚óÜ</span>
                Â∫îÊÄ•ÊåáÊå•
            </div>
            <div class="menu-item">
                <span class="menu-icon">‚óà</span>
                Á≥ªÁªüËÆæÁΩÆ
            </div>
        </nav>

        <!-- ‰∏≠Â§ÆÂú∞ÂõæÂå∫Âüü -->
        <main class="map-container">
            <!-- Âú∞ÂõæÂ∑•ÂÖ∑Ê†è -->
            <div class="map-toolbar">
                <button class="toolbar-btn active" id="homeBtn">‚óé ÂõûÂà∞ÊàêÈÉΩ</button>
                <button class="toolbar-btn active" id="terrainBtn">‚ñ≤ ÂÖ≥Èó≠Âú∞ÂΩ¢</button>
                <button class="toolbar-btn" id="boundaryBtn">‚óá Ë°åÊîøÂå∫Âàí</button>
                <button class="toolbar-btn" id="imageryBtn">‚óà ÂàáÊç¢ÂΩ±ÂÉè</button>
                <button class="toolbar-btn" id="addPointBtn">‚óè Ê∑ªÂä†ÁõëÊµãÁÇπ</button>
                <button class="toolbar-btn" id="addAreaBtn">‚ñ≥ Ê∑ªÂä†È¢ÑË≠¶Âå∫Âüü</button>
                <button class="toolbar-btn" id="clearBtn">‚óå Ê∏ÖÈô§ÊâÄÊúâ</button>
            </div>
            
            <!-- CesiumJS ÂÆπÂô® -->
            <div id="cesiumContainer"></div>
        </main>

        <!-- Âè≥‰æß‰ø°ÊÅØÈù¢Êùø -->
        <aside class="info-panel">
            <!-- KPIÊåáÊ†áÂç°Áâá -->
            <div class="kpi-cards">
                <div class="kpi-card">
                    <div class="kpi-value" id="onlineDevices">98.5%</div>
                    <div class="kpi-label">Âú®Á∫øËÆæÂ§áÁéá</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value" id="dataIntegrity">95.2%</div>
                    <div class="kpi-label">Êï∞ÊçÆÂÆåÊï¥ÊÄß</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value" id="todayWarnings">3</div>
                    <div class="kpi-label">ÂΩìÊó•È¢ÑË≠¶</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-value" id="processingEvents">1</div>
                    <div class="kpi-label">Â§ÑÁêÜ‰∏≠‰∫ã‰ª∂</div>
                </div>
            </div>

            <!-- ÊúÄÊñ∞È¢ÑË≠¶‰ø°ÊÅØ -->
            <div class="warning-section">
                <h3 class="section-title">
                    <span>‚ñ≥</span>
                    ÊúÄÊñ∞È¢ÑË≠¶‰ø°ÊÅØ
                </h3>
                <div class="warning-list" id="warningList">
                    <!-- È¢ÑË≠¶È°πÁõÆÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>

            <!-- ËÆæÂ§áÁä∂ÊÄÅ -->
            <div class="device-status">
                <h3 class="section-title">
                    <span>‚óâ</span>
                    ËÆæÂ§áÁä∂ÊÄÅ
                </h3>
                <div id="deviceList">
                    <!-- ËÆæÂ§áÁä∂ÊÄÅÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>

            <!-- ÂÆûÊó∂ÈÄöÁü• -->
            <div class="notification-section">
                <h3 class="section-title">
                    <span>‚óà</span>
                    ÂÆûÊó∂ÈÄöÁü•
                </h3>
                <div id="notificationList">
                    <!-- ÈÄöÁü•Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>
        </aside>
    </div>

    <!-- Â∫ïÈÉ®Áä∂ÊÄÅÊ†è -->
    <footer class="footer">
        <div class="footer-left">
            <span>ÁõëÊµãÁÇπÊÄªÊï∞: <span id="totalPoints">156</span></span>
            <span style="margin-left: 24px;">Âú®Á∫øËÆæÂ§á: <span id="onlinePoints">154</span></span>
        </div>
        <div class="footer-center">
            <span>ÊúÄÂêéÊõ¥Êñ∞: <span id="lastUpdate">2024-07-17 14:30:25</span></span>
        </div>
        <div class="footer-right">
            <span>Á≥ªÁªüÁâàÊú¨: v2.1.0</span>
        </div>
    </footer>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let viewer = null;
        let pointCount = 0;
        let terrainEnabled = true;
        let boundaryEnabled = false;
        let imageryIndex = 0;
        let boundaryDataSource = null;

        // Á≥ªÁªüÂàùÂßãÂåñ
        class GeologicalDisasterDashboard {
            constructor() {
                this.init();
            }

            async init() {
                try {
                    console.log('üåç ÂàùÂßãÂåñÂú∞Ë¥®ÁÅæÂÆ≥È¢ÑË≠¶Á≥ªÁªü...');
                    
                    // Êõ¥Êñ∞Âä†ËΩΩËøõÂ∫¶
                    this.updateLoadingProgress('Ê≠£Âú®Âä†ËΩΩCesiumJS...');
                    
                    // Ê£ÄÊü•CesiumÊòØÂê¶Âä†ËΩΩ
                    if (typeof Cesium === 'undefined') {
                        throw new Error('CesiumJS CDNÂ∫ìÊú™Âä†ËΩΩ');
                    }
                    
                    // ËÆæÁΩÆCesium Ion Token (‰ΩøÁî®ÊúâÊïàÁöÑtoken)
                    Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI2YjZlZDZhMS0xZGMzLTRlMjAtOWMyMC1hY2U2ZGI1OWM3YzIiLCJpZCI6MzIyMjE3LCJpYXQiOjE3NTI3MTgyMDZ9.ESrgN3eQQTxnHv-UUG5aJz7ojlnK9EAzfqFqgXPmH7M';

                    this.updateLoadingProgress('Ê≠£Âú®ÂàùÂßãÂåñ3DÂú∞ÁêÉ...');

                    // ÂàùÂßãÂåñCesium Viewer (‰ΩøÁî®‰∏ñÁïåÂú∞ÂΩ¢)
                    viewer = new Cesium.Viewer('cesiumContainer', {
                        terrainProvider: await Cesium.createWorldTerrainAsync({
                            requestWaterMask: true,
                            requestVertexNormals: true
                        }),
                        imageryProvider: new Cesium.OpenStreetMapImageryProvider({
                            url: 'https://tile.openstreetmap.org/',
                            fileExtension: 'png'
                        }),
                        baseLayerPicker: false,
                        geocoder: false,
                        homeButton: false,
                        sceneModePicker: false,
                        navigationHelpButton: false,
                        animation: false,
                        timeline: false,
                        fullscreenButton: false,
                        vrButton: false
                    });

                    // ËÆæÁΩÆÂàùÂßãÂú∞ÂΩ¢Áä∂ÊÄÅ
                    terrainEnabled = true;
                    
                    this.updateLoadingProgress('Ê≠£Âú®ÈÖçÁΩÆÂú∫ÊôØ...');
                    
                    // ÈÖçÁΩÆÂú∫ÊôØ
                    this.configureScene();
                    
                    this.updateLoadingProgress('Ê≠£Âú®ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®...');
                    
                    // ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
                    this.setupEventListeners();
                    
                    this.updateLoadingProgress('Ê≠£Âú®Ê∑ªÂä†ÂàùÂßãÂÜÖÂÆπ...');
                    
                    // Ê∑ªÂä†ÂàùÂßãÂÜÖÂÆπ
                    this.addInitialContent();
                    
                    this.updateLoadingProgress('Ê≠£Âú®È£ûÂà∞ÊàêÈÉΩ...');
                    
                    // È£ûÂà∞ÊàêÈÉΩ
                    await this.flyToChengdu();
                    
                    this.updateLoadingProgress('Ê≠£Âú®ÂàùÂßãÂåñÊï∞ÊçÆ...');
                    
                    // ÂàùÂßãÂåñÊ®°ÊãüÊï∞ÊçÆ
                    this.initializeData();
                    
                    this.updateLoadingProgress('ÂêØÂä®ÂÆûÊó∂Êï∞ÊçÆÊõ¥Êñ∞...');
                    
                    // ÂêØÂä®ÂÆûÊó∂Êï∞ÊçÆÊõ¥Êñ∞
                    this.startRealTimeUpdates();
                    
                    // ÈöêËóèÂä†ËΩΩÈÅÆÁΩ©
                    this.hideLoading();
                    
                    console.log('‚úÖ Âú∞Ë¥®ÁÅæÂÆ≥È¢ÑË≠¶Á≥ªÁªüÂàùÂßãÂåñÂÆåÊàê');
                    
                } catch (error) {
                    console.error('‚ùå Á≥ªÁªüÂàùÂßãÂåñÂ§±Ë¥•:', error);
                    this.showError(error.message);
                }
            }

            updateLoadingProgress(message) {
                const progressElement = document.querySelector('.loading-progress');
                if (progressElement) {
                    progressElement.textContent = message;
                }
            }

            hideLoading() {
                setTimeout(() => {
                    const overlay = document.getElementById('loadingOverlay');
                    if (overlay) {
                        overlay.style.opacity = '0';
                        setTimeout(() => {
                            overlay.style.display = 'none';
                        }, 500);
                    }
                }, 1000);
            }

            showError(message) {
                const overlay = document.getElementById('loadingOverlay');
                if (overlay) {
                    overlay.innerHTML = `
                        <div style="text-align: center;">
                            <div style="font-size: 48px; color: #FF4757; margin-bottom: 20px;">‚ùå</div>
                            <div style="color: #FF4757; font-size: 18px; margin-bottom: 10px;">Á≥ªÁªüÂàùÂßãÂåñÂ§±Ë¥•</div>
                            <div style="font-size: 14px; color: #B8C5D6;">${message}</div>
                            <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; background: #1890FF; color: white; border: none; border-radius: 6px; cursor: pointer;">ÈáçÊñ∞Âä†ËΩΩ</button>
                        </div>
                    `;
                }
            }

            configureScene() {
                const scene = viewer.scene;

                // Âü∫Á°ÄÂú∫ÊôØÈÖçÁΩÆ
                scene.globe.enableLighting = true;
                scene.fog.enabled = true;
                scene.fog.density = 0.0001;
                scene.fog.screenSpaceErrorFactor = 2.0;

                // ‰ºòÂåñÊÄßËÉΩËÆæÁΩÆ
                scene.globe.maximumScreenSpaceError = 2;
                scene.globe.tileCacheSize = 100;

                // Á¶ÅÁî®Ê∑±Â∫¶ÊµãËØï‰ª•Á°Æ‰øùËæπÁïåÊòæÁ§∫
                scene.globe.depthTestAgainstTerrain = false;

                console.log('üé¨ Âú∫ÊôØÈÖçÁΩÆÂÆåÊàê');
            }

            setupEventListeners() {
                // ÊåâÈíÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
                document.getElementById('homeBtn').addEventListener('click', () => this.flyToChengdu());
                document.getElementById('addPointBtn').addEventListener('click', () => this.addMonitoringPoint());
                document.getElementById('addAreaBtn').addEventListener('click', () => this.addWarningArea());
                document.getElementById('terrainBtn').addEventListener('click', (e) => this.toggleTerrain(e));
                document.getElementById('boundaryBtn').addEventListener('click', (e) => this.toggleBoundary(e));
                document.getElementById('imageryBtn').addEventListener('click', (e) => this.toggleImagery(e));
                document.getElementById('clearBtn').addEventListener('click', () => this.clearAll());

                // ÈîÆÁõòÂø´Êç∑ÈîÆ
                document.addEventListener('keydown', (e) => this.handleKeyboard(e));

                console.log('‚ö° ‰∫ã‰ª∂ÁõëÂê¨Âô®Â∑≤ËÆæÁΩÆ');
            }

            async flyToChengdu() {
                if (!viewer) return;

                return viewer.camera.flyTo({
                    destination: Cesium.Cartesian3.fromDegrees(104.0668, 30.5728, 50000),
                    orientation: {
                        heading: 0,
                        pitch: Cesium.Math.toRadians(-45),
                        roll: 0
                    },
                    duration: 2.0
                });
            }

            addInitialContent() {
                if (!viewer) return;

                // Ê∑ªÂä†ÊàêÈÉΩÊ†áËÆ∞
                viewer.entities.add({
                    id: 'chengdu-city',
                    name: 'ÊàêÈÉΩÂ∏Ç',
                    position: Cesium.Cartesian3.fromDegrees(104.0668, 30.5728),
                    point: {
                        pixelSize: 15,
                        color: Cesium.Color.YELLOW,
                        outlineColor: Cesium.Color.BLACK,
                        outlineWidth: 2,
                        heightReference: Cesium.HeightReference.CLAMP_TO_GROUND
                    },
                    label: {
                        text: 'ÊàêÈÉΩÂ∏Ç',
                        font: '16pt sans-serif',
                        fillColor: Cesium.Color.YELLOW,
                        outlineColor: Cesium.Color.BLACK,
                        outlineWidth: 2,
                        style: Cesium.LabelStyle.FILL_AND_OUTLINE,
                        pixelOffset: new Cesium.Cartesian2(0, -40),
                        heightReference: Cesium.HeightReference.CLAMP_TO_GROUND
                    }
                });

                console.log('üìç ÂàùÂßãÂÜÖÂÆπÂ∑≤Ê∑ªÂä†');
            }

            addMonitoringPoint() {
                const names = ['ÁõëÊµãÁÇπA', 'ÁõëÊµãÁÇπB', 'ÁõëÊµãÁÇπC', 'ÁõëÊµãÁÇπD', 'ÁõëÊµãÁÇπE'];
                const statuses = ['normal', 'warning', 'danger', 'normal'];

                const name = names[Math.floor(Math.random() * names.length)] + '-' + (pointCount + 1);
                const lon = 104.0668 + (Math.random() - 0.5) * 0.5;
                const lat = 30.5728 + (Math.random() - 0.5) * 0.5;
                const status = statuses[Math.floor(Math.random() * statuses.length)];

                this.addPointToMap(name, lon, lat, status);
            }

            addPointToMap(name, lon, lat, status) {
                const colors = {
                    normal: Cesium.Color.LIME,
                    warning: Cesium.Color.YELLOW,
                    danger: Cesium.Color.RED,
                    offline: Cesium.Color.GRAY
                };

                viewer.entities.add({
                    id: `monitoring-point-${pointCount}`,
                    name: name,
                    position: Cesium.Cartesian3.fromDegrees(lon, lat),
                    point: {
                        pixelSize: 12,
                        color: colors[status],
                        outlineColor: Cesium.Color.BLACK,
                        outlineWidth: 2,
                        heightReference: Cesium.HeightReference.CLAMP_TO_GROUND
                    },
                    label: {
                        text: name,
                        font: '12pt sans-serif',
                        fillColor: colors[status],
                        outlineColor: Cesium.Color.BLACK,
                        outlineWidth: 1,
                        style: Cesium.LabelStyle.FILL_AND_OUTLINE,
                        pixelOffset: new Cesium.Cartesian2(0, -30),
                        heightReference: Cesium.HeightReference.CLAMP_TO_GROUND
                    }
                });

                pointCount++;
                this.updatePointCount();
                console.log('üìç Â∑≤Ê∑ªÂä†ÁõëÊµãÁÇπ:', name);
            }

            addWarningArea() {
                const areaId = 'warning-area-' + Date.now();
                const centerLon = 104.0668 + (Math.random() - 0.5) * 0.3;
                const centerLat = 30.5728 + (Math.random() - 0.5) * 0.3;
                const size = 0.05 + Math.random() * 0.05;

                viewer.entities.add({
                    id: areaId,
                    name: 'È¢ÑË≠¶Âå∫Âüü',
                    polygon: {
                        hierarchy: Cesium.Cartesian3.fromDegreesArray([
                            centerLon - size, centerLat - size,
                            centerLon + size, centerLat - size,
                            centerLon + size, centerLat + size,
                            centerLon - size, centerLat + size
                        ]),
                        material: Cesium.Color.RED.withAlpha(0.3),
                        outline: true,
                        outlineColor: Cesium.Color.RED,
                        height: 0,
                        extrudedHeight: 1000
                    }
                });

                console.log('‚ö†Ô∏è Â∑≤Ê∑ªÂä†È¢ÑË≠¶Âå∫Âüü:', areaId);
            }

            initializeData() {
                // ÂàùÂßãÂåñÈ¢ÑË≠¶Êï∞ÊçÆ
                this.updateWarningList();

                // ÂàùÂßãÂåñËÆæÂ§áÁä∂ÊÄÅ
                this.updateDeviceStatus();

                // ÂàùÂßãÂåñÈÄöÁü•
                this.updateNotifications();

                console.log('üìä Ê®°ÊãüÊï∞ÊçÆÂ∑≤ÂàùÂßãÂåñ');
            }

            updateWarningList() {
                const warnings = [
                    {
                        level: 'red',
                        levelText: 'Á∫¢Ëâ≤È¢ÑË≠¶',
                        content: 'XXÊùëÊªëÂù°È£éÈô©ÊûÅÈ´òÔºåËØ∑Á´ãÂç≥Êí§Á¶ª',
                        time: '14:25'
                    },
                    {
                        level: 'orange',
                        levelText: 'Ê©ôËâ≤È¢ÑË≠¶',
                        content: 'XXÈïáÊ≥•Áü≥ÊµÅÈ£éÈô©ËæÉÈ´òÔºåÊ≥®ÊÑèÈò≤ËåÉ',
                        time: '13:45'
                    },
                    {
                        level: 'yellow',
                        levelText: 'ÈªÑËâ≤È¢ÑË≠¶',
                        content: 'XXÂéøÂú∞Ë¥®ÁÅæÂÆ≥È£éÈô©‰∏ÄËà¨Ôºå‰øùÊåÅË≠¶ÊÉï',
                        time: '12:30'
                    }
                ];

                const warningList = document.getElementById('warningList');
                warningList.innerHTML = warnings.map(warning => `
                    <div class="warning-item ${warning.level}">
                        <div class="warning-header">
                            <span class="warning-level ${warning.level}">${warning.levelText}</span>
                            <span class="warning-time">${warning.time}</span>
                        </div>
                        <div class="warning-content">${warning.content}</div>
                    </div>
                `).join('');
            }

            updateDeviceStatus() {
                const devices = [
                    { name: 'ÁõëÊµãÁ´ô001', status: 'online' },
                    { name: 'ÁõëÊµãÁ´ô002', status: 'online' },
                    { name: 'ÁõëÊµãÁ´ô003', status: 'warning' },
                    { name: 'ÁõëÊµãÁ´ô004', status: 'online' },
                    { name: 'ÁõëÊµãÁ´ô005', status: 'offline' }
                ];

                const deviceList = document.getElementById('deviceList');
                deviceList.innerHTML = devices.map(device => `
                    <div class="device-item">
                        <span class="device-name">${device.name}</span>
                        <div class="device-status-dot ${device.status}"></div>
                    </div>
                `).join('');
            }

            updateNotifications() {
                const notifications = [
                    'Á≥ªÁªüËá™Ê£ÄÂÆåÊàêÔºåÊâÄÊúâÊ®°ÂùóÊ≠£Â∏∏ËøêË°å',
                    'Êñ∞Â¢û3‰∏™ÁõëÊµãÁÇπÊï∞ÊçÆÊé•ÂÖ•',
                    'È¢ÑË≠¶Êé®ÈÄÅÊúçÂä°Â∑≤ÂêØÂä®',
                    'Êï∞ÊçÆÂ§á‰ªΩ‰ªªÂä°ÊâßË°åÊàêÂäü'
                ];

                const notificationList = document.getElementById('notificationList');
                notificationList.innerHTML = notifications.map(notification => `
                    <div class="device-item">
                        <span class="device-name">${notification}</span>
                    </div>
                `).join('');
            }

            updatePointCount() {
                document.getElementById('totalPoints').textContent = 156 + pointCount;
                document.getElementById('onlinePoints').textContent = 154 + pointCount;
            }

            startRealTimeUpdates() {
                // ÊØè30ÁßíÊõ¥Êñ∞‰∏ÄÊ¨°Êï∞ÊçÆ
                setInterval(() => {
                    this.updateKPIData();
                    this.updateLastUpdateTime();
                }, 30000);

                // ÊØè5ÂàÜÈíüÊõ¥Êñ∞‰∏ÄÊ¨°È¢ÑË≠¶‰ø°ÊÅØ
                setInterval(() => {
                    this.updateWarningList();
                }, 300000);

                console.log('üîÑ ÂÆûÊó∂Êï∞ÊçÆÊõ¥Êñ∞Â∑≤ÂêØÂä®');
            }

            updateKPIData() {
                // Ê®°ÊãüKPIÊï∞ÊçÆÂèòÂåñ
                const onlineRate = (98 + Math.random() * 2).toFixed(1);
                const dataIntegrity = (94 + Math.random() * 4).toFixed(1);
                const todayWarnings = Math.floor(Math.random() * 5) + 1;
                const processingEvents = Math.floor(Math.random() * 3);

                document.getElementById('onlineDevices').textContent = onlineRate + '%';
                document.getElementById('dataIntegrity').textContent = dataIntegrity + '%';
                document.getElementById('todayWarnings').textContent = todayWarnings;
                document.getElementById('processingEvents').textContent = processingEvents;
            }

            updateLastUpdateTime() {
                const now = new Date();
                const timeString = now.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                document.getElementById('lastUpdate').textContent = timeString;
            }

            async toggleTerrain(event) {
                if (!viewer) return;

                const btn = event.target;
                btn.disabled = true;

                try {
                    terrainEnabled = !terrainEnabled;

                    if (terrainEnabled) {
                        // Â∞ùËØïÂêØÁî®‰∏ñÁïåÂú∞ÂΩ¢ÔºåÂ¶ÇÊûúÂ§±Ë¥•Âàô‰ΩøÁî®Ê§≠ÁêÉ‰Ωì
                        try {
                            if (typeof Cesium.createWorldTerrainAsync === 'function') {
                                viewer.terrainProvider = await Cesium.createWorldTerrainAsync({
                                    requestWaterMask: true,
                                    requestVertexNormals: true
                                });
                            } else if (typeof Cesium.createWorldTerrain === 'function') {
                                viewer.terrainProvider = Cesium.createWorldTerrain({
                                    requestWaterMask: true,
                                    requestVertexNormals: true
                                });
                            } else {
                                throw new Error('‰∏ñÁïåÂú∞ÂΩ¢API‰∏çÂèØÁî®');
                            }
                            btn.textContent = 'üèîÔ∏è ÂÖ≥Èó≠Âú∞ÂΩ¢';
                            console.log('üèîÔ∏è ‰∏ñÁïåÂú∞ÂΩ¢Â∑≤ÂêØÁî®');
                        } catch (terrainError) {
                            console.warn('‰∏ñÁïåÂú∞ÂΩ¢Âä†ËΩΩÂ§±Ë¥•Ôºå‰ΩøÁî®Ê§≠ÁêÉ‰ΩìÂú∞ÂΩ¢:', terrainError);
                            viewer.terrainProvider = new Cesium.EllipsoidTerrainProvider();
                            terrainEnabled = false;
                            btn.textContent = 'üèîÔ∏è ÂºÄÂêØÂú∞ÂΩ¢';
                            console.log('üåç ÈôçÁ∫ßÂà∞Ê§≠ÁêÉ‰ΩìÂú∞ÂΩ¢');
                        }
                    } else {
                        viewer.terrainProvider = new Cesium.EllipsoidTerrainProvider();
                        btn.textContent = 'üèîÔ∏è ÂºÄÂêØÂú∞ÂΩ¢';
                        console.log('üåç Ê§≠ÁêÉ‰ΩìÂú∞ÂΩ¢Â∑≤ÂêØÁî®');
                    }

                    btn.classList.toggle('active', terrainEnabled);
                } catch (error) {
                    console.error('Âú∞ÂΩ¢ÂàáÊç¢Â§±Ë¥•:', error);
                    terrainEnabled = false;
                    btn.textContent = 'üèîÔ∏è ÂºÄÂêØÂú∞ÂΩ¢';
                } finally {
                    btn.disabled = false;
                }
            }

            async toggleBoundary(event) {
                if (!viewer) return;

                const btn = event.target;
                btn.disabled = true;

                try {
                    boundaryEnabled = !boundaryEnabled;

                    if (boundaryEnabled) {
                        await this.loadAdministrativeBoundaries();
                        btn.textContent = 'üóæ ÂÖ≥Èó≠Âå∫Âàí';
                        console.log('üóæ Ë°åÊîøÂå∫ÂàíÂ∑≤ÂêØÁî®');
                    } else {
                        this.removeAdministrativeBoundaries();
                        btn.textContent = 'üóæ Ë°åÊîøÂå∫Âàí';
                        console.log('üóæ Ë°åÊîøÂå∫ÂàíÂ∑≤ÂÖ≥Èó≠');
                    }

                    btn.classList.toggle('active', boundaryEnabled);
                } catch (error) {
                    console.error('Ë°åÊîøÂå∫ÂàíÂàáÊç¢Â§±Ë¥•:', error);
                    boundaryEnabled = false;
                    btn.textContent = 'üóæ Ë°åÊîøÂå∫Âàí';
                } finally {
                    btn.disabled = false;
                }
            }

            async loadAdministrativeBoundaries() {
                // ÂÖàÊ∏ÖÈô§Áé∞ÊúâÁöÑË°åÊîøÂå∫ÂàíÊï∞ÊçÆ
                this.removeAdministrativeBoundaries();

                // ÂàõÂª∫Êï∞ÊçÆÊ∫ê
                boundaryDataSource = new Cesium.CustomDataSource('Ë°åÊîøÂå∫Âàí');
                viewer.dataSources.add(boundaryDataSource);

                // Âä†ËΩΩÂõõÂ∑ùÁúÅËæπÁïå
                await this.loadSichuanBoundary();

                // Âä†ËΩΩÊàêÈÉΩÂ∏ÇËæπÁïå
                await this.loadChengduBoundary();
            }

            async loadSichuanBoundary() {
                const sichuanBoundary = [
                    97.35, 32.99, 99.17, 33.97, 100.58, 33.30, 102.72, 33.40,
                    104.07, 33.30, 105.92, 32.85, 107.89, 31.85, 108.54, 31.16,
                    108.25, 30.05, 107.89, 28.93, 106.96, 28.23, 105.97, 27.99,
                    104.52, 27.88, 103.04, 27.74, 101.89, 27.99, 100.32, 28.29,
                    99.15, 28.97, 98.47, 29.84, 97.91, 30.93, 97.35, 32.99
                ];

                // Ê∑ªÂä†polygonÂ°´ÂÖÖ
                boundaryDataSource.entities.add({
                    id: 'sichuan-province-fill',
                    name: 'ÂõõÂ∑ùÁúÅÂ°´ÂÖÖ',
                    polygon: {
                        hierarchy: Cesium.Cartesian3.fromDegreesArray(sichuanBoundary),
                        material: Cesium.Color.CYAN.withAlpha(0.1),
                        outline: false,
                        height: 30000,
                        extrudedHeight: 60000,
                        heightReference: Cesium.HeightReference.RELATIVE_TO_GROUND
                    }
                });

                // Ê∑ªÂä†polylineËæπÁïåÁ∫ø
                boundaryDataSource.entities.add({
                    id: 'sichuan-province',
                    name: 'ÂõõÂ∑ùÁúÅ',
                    polyline: {
                        positions: Cesium.Cartesian3.fromDegreesArray(sichuanBoundary),
                        width: 6,
                        material: new Cesium.PolylineGlowMaterialProperty({
                            glowPower: 0.2,
                            color: Cesium.Color.CYAN
                        }),
                        clampToGround: false,
                        heightReference: Cesium.HeightReference.RELATIVE_TO_GROUND,
                        zIndex: 900
                    },
                    label: {
                        text: 'ÂõõÂ∑ùÁúÅ',
                        font: '18pt sans-serif',
                        fillColor: Cesium.Color.CYAN,
                        outlineColor: Cesium.Color.BLACK,
                        outlineWidth: 3,
                        style: Cesium.LabelStyle.FILL_AND_OUTLINE,
                        pixelOffset: new Cesium.Cartesian2(0, -35),
                        show: true,
                        scale: 1.1
                    }
                });
            }

            async loadChengduBoundary() {
                const chengduBoundary = [
                    102.54, 31.42, 103.17, 31.47, 104.33, 31.23, 104.70, 30.98,
                    104.85, 30.39, 104.37, 30.03, 103.94, 29.97, 103.46, 30.41,
                    103.07, 30.63, 102.54, 31.42
                ];

                // Ê∑ªÂä†polygonÂ°´ÂÖÖ
                boundaryDataSource.entities.add({
                    id: 'chengdu-city-fill',
                    name: 'ÊàêÈÉΩÂ∏ÇÂ°´ÂÖÖ',
                    polygon: {
                        hierarchy: Cesium.Cartesian3.fromDegreesArray(chengduBoundary),
                        material: Cesium.Color.YELLOW.withAlpha(0.2),
                        outline: false,
                        height: 20000,
                        extrudedHeight: 40000,
                        heightReference: Cesium.HeightReference.RELATIVE_TO_GROUND
                    }
                });

                // Ê∑ªÂä†polylineËæπÁïåÁ∫ø
                boundaryDataSource.entities.add({
                    id: 'chengdu-city',
                    name: 'ÊàêÈÉΩÂ∏Ç',
                    polyline: {
                        positions: Cesium.Cartesian3.fromDegreesArray(chengduBoundary),
                        width: 5,
                        material: new Cesium.PolylineGlowMaterialProperty({
                            glowPower: 0.2,
                            color: Cesium.Color.YELLOW
                        }),
                        clampToGround: false,
                        heightReference: Cesium.HeightReference.RELATIVE_TO_GROUND,
                        zIndex: 800
                    },
                    label: {
                        text: 'ÊàêÈÉΩÂ∏Ç',
                        font: '16pt sans-serif',
                        fillColor: Cesium.Color.YELLOW,
                        outlineColor: Cesium.Color.BLACK,
                        outlineWidth: 2,
                        style: Cesium.LabelStyle.FILL_AND_OUTLINE,
                        pixelOffset: new Cesium.Cartesian2(0, -30),
                        show: true
                    }
                });
            }

            removeAdministrativeBoundaries() {
                if (boundaryDataSource) {
                    viewer.dataSources.remove(boundaryDataSource);
                    boundaryDataSource = null;
                }
            }

            toggleImagery(event) {
                if (!viewer) return;

                const btn = event.target;
                btn.disabled = true;

                try {
                    const imageryProviders = [
                        {
                            name: 'Ë°óÈÅìÂú∞Âõæ',
                            provider: () => new Cesium.OpenStreetMapImageryProvider({
                                url: 'https://tile.openstreetmap.org/',
                                fileExtension: 'png'
                            })
                        },
                        {
                            name: 'Âç´ÊòüÂΩ±ÂÉè',
                            provider: () => new Cesium.UrlTemplateImageryProvider({
                                url: 'https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',
                                maximumLevel: 18,
                                credit: 'Google Earth'
                            })
                        },
                        {
                            name: 'Âú∞ÂΩ¢Âõæ',
                            provider: () => new Cesium.UrlTemplateImageryProvider({
                                url: 'https://mt1.google.com/vt/lyrs=p&x={x}&y={y}&z={z}',
                                maximumLevel: 18,
                                credit: 'Google Terrain'
                            })
                        }
                    ];

                    // Á°Æ‰øùÁ¥¢ÂºïÊúâÊïà
                    if (imageryIndex >= imageryProviders.length) {
                        imageryIndex = 0;
                    }

                    // Âæ™ÁéØÂàáÊç¢ÂΩ±ÂÉè
                    imageryIndex = (imageryIndex + 1) % imageryProviders.length;
                    const currentImagery = imageryProviders[imageryIndex];

                    console.log(`üîÑ ÂàáÊç¢Âà∞Á¥¢Âºï ${imageryIndex}: ${currentImagery.name}`);

                    // ÁßªÈô§ÂΩìÂâçÂΩ±ÂÉèÂ±Ç
                    viewer.imageryLayers.removeAll();

                    // Ê∑ªÂä†Êñ∞ÁöÑÂΩ±ÂÉèÂ±Ç
                    try {
                        const provider = currentImagery.provider();
                        const imageryLayer = new Cesium.ImageryLayer(provider);
                        viewer.imageryLayers.add(imageryLayer);

                        // Êõ¥Êñ∞ÊåâÈíÆÊñáÊú¨
                        btn.textContent = `üó∫Ô∏è ${currentImagery.name}`;
                        console.log('‚úÖ ÊàêÂäüÂàáÊç¢Âà∞:', currentImagery.name);

                    } catch (providerError) {
                        console.error(`‚ùå ÂΩ±ÂÉèÊèê‰æõËÄÖ ${currentImagery.name} ÂàõÂª∫Â§±Ë¥•:`, providerError);

                        // ‰ΩøÁî®ÊúÄÂü∫Êú¨ÁöÑOpenStreetMap‰Ωú‰∏∫Â§áÁî®
                        const fallbackProvider = new Cesium.OpenStreetMapImageryProvider({
                            url: 'https://a.tile.openstreetmap.org/'
                        });
                        viewer.imageryLayers.add(new Cesium.ImageryLayer(fallbackProvider));
                        btn.textContent = 'üó∫Ô∏è Ë°óÈÅìÂú∞Âõæ';
                        console.log('üîÑ Â∑≤ÈôçÁ∫ßÂà∞Âü∫Á°ÄË°óÈÅìÂú∞Âõæ');
                    }

                } catch (error) {
                    console.error('‚ùå ÂΩ±ÂÉèÂàáÊç¢Â§±Ë¥•:', error);
                    btn.textContent = 'üó∫Ô∏è ÂàáÊç¢ÂΩ±ÂÉè';
                } finally {
                    btn.disabled = false;
                }
            }

            clearAll() {
                if (!viewer) return;

                // Ê∏ÖÈô§ÊâÄÊúâÂÆû‰ΩìÔºàÈô§‰∫ÜÊàêÈÉΩÊ†áËÆ∞Ôºâ
                const entities = viewer.entities.values;
                for (let i = entities.length - 1; i >= 0; i--) {
                    if (entities[i].id !== 'chengdu-city') {
                        viewer.entities.remove(entities[i]);
                    }
                }

                pointCount = 0;
                this.updatePointCount();

                console.log('üóëÔ∏è Â∑≤Ê∏ÖÈô§ÊâÄÊúâÁõëÊµãÁÇπÂíåÈ¢ÑË≠¶Âå∫Âüü');
            }

            handleKeyboard(e) {
                switch (e.key.toLowerCase()) {
                    case 'h':
                        this.flyToChengdu();
                        break;
                    case 'p':
                        this.addMonitoringPoint();
                        break;
                    case 'w':
                        this.addWarningArea();
                        break;
                    case 't':
                        document.getElementById('terrainBtn').click();
                        break;
                    case 'b':
                        document.getElementById('boundaryBtn').click();
                        break;
                    case 'i':
                        document.getElementById('imageryBtn').click();
                        break;
                    case 'c':
                        this.clearAll();
                        break;
                }
            }
        }

        // ÂêØÂä®Â∫îÁî®
        document.addEventListener('DOMContentLoaded', () => {
            new GeologicalDisasterDashboard();
        });
    </script>
</body>
</html>
